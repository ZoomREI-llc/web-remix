(()=>{"use strict";const e=e=>{const t=e.keyCode;return!0===e.shiftKey||35===t||36===t||8===t||9===t||13===t||46===t||t>36&&t<41||(!0===e.ctrlKey||!0===e.metaKey)&&(65===t||67===t||86===t||88===t||90===t)},t=t=>{(e=>{const t=e.keyCode;return t>=48&&t<=57||t>=96&&t<=105})(t)||e(t)||t.preventDefault()},o=t=>{if(e(t))return;const o=t.target.value.replace(/\D/g,"").substring(0,10),n=o.substring(0,3),r=o.substring(3,6),a=o.substring(6,10);o.length>6?t.target.value=`(${n}) ${r} - ${a}`:o.length>3?t.target.value=`(${n}) ${r}`:o.length>0&&(t.target.value=`(${n}`)};function n(e){e.preventDefault();const t=e.target,o=t.querySelector('input[name="address"]'),n=t.querySelector('input[name="full_name"]'),a=t.querySelector('input[name="email"]'),s=t.querySelector('input[name="phone"]'),l=t.querySelector('textarea[name="message"]');let i=!0;if(""===l.value.trim()?(l.setCustomValidity("Please fill out this field."),l.reportValidity(),i=!1):l.setCustomValidity(""),o.value?o.setCustomValidity(""):(r(o),o.setCustomValidity("Please use autocomplete to enter a complete address."),o.reportValidity(),i=!1),!i)return void console.log("Form validation failed");const c={property_address:o.value,name:n.value,email:a.value,phone:s.value,message:l.value,heard_about_us:t.querySelector('input[name="contact"]:checked')?t.querySelector('input[name="contact"]:checked').value:null};console.log("Submitting to WordPress endpoint"),console.log("Form data:",c),fetch("/wp-json/custom/v1/submit-form",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{console.log("Response from WordPress endpoint:",e),gsap.to("#contact-form",{duration:.5,opacity:0,onComplete:()=>{t.style.display="none",gsap.to(".contact-form__success",{duration:.5,display:"flex",opacity:1})}})})).catch((e=>{console.error("Error sending data to webhook:",e)}))}function r(e){e.classList.add("invalid"),e.setCustomValidity("Invalid address"),e.reportValidity()}function a(){console.log("initAutocomplete called");const e=document.getElementById("contact-form");if(!e)return void console.error("Custom form not found.");const n=e.querySelector('input[name="address"]'),a=e.querySelector('input[name="full_name"]'),s=e.querySelector('input[name="email"]'),l=e.querySelector('input[name="phone"]'),i=e.querySelector('textarea[name="message"]');if(!(n&&a&&s&&l&&i))return void console.error("Required fields not found, skipping form.");console.log("All required fields found"),l.addEventListener("keydown",t),l.addEventListener("keyup",o);let c=!1;n.addEventListener("input",(function(){console.log("Address input changed"),c=!1,n.setCustomValidity("")})),i.addEventListener("input",(function(){i.setCustomValidity("")})),e.addEventListener("keypress",(function(e){"Enter"!==e.key||n.value||e.preventDefault()})),console.log("Initializing Google Maps Autocomplete");const u=new google.maps.places.Autocomplete(n,{types:["address"],componentRestrictions:{country:"us"}});u.addListener("place_changed",(function(){console.log("Place changed");const e=u.getPlace();if(!e.geometry)return console.error("No geometry found for the place"),r(n),void(c=!1);let t="",o="",a="",s="",l=!1;for(const n of e.address_components)switch(n.types[0]){case"street_number":t=n.long_name,l=!0;break;case"route":t+=" "+n.long_name;break;case"locality":o=n.long_name;break;case"administrative_area_level_1":a=n.short_name;break;case"postal_code":s=n.long_name}if(!l)return console.error("Selected place does not have a street number"),r(n),void(c=!1);n.value=`${t}, ${o}, ${a} ${s}`,n.value&&(n.classList.remove("invalid"),n.placeholder="Your Address",n.style.borderColor="",c=!0,n.setCustomValidity(""))}))}window.addEventListener("load",(e=>{const t=document.querySelector("#contact-form");t&&(t.style.opacity="1",t.addEventListener("submit",n))})),window.initAutocomplete=a,document.addEventListener("DOMContentLoaded",(function(){loadScript(`https://maps.googleapis.com/maps/api/js?key=${formConfig.googleMapsApiKey}&libraries=places`,a)}))})();